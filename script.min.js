// Mobile Navigation Toggle
const mobileMenu=document.getElementById('mobile-menu');const navMenu=document.querySelector('.nav-menu');mobileMenu.addEventListener('click',()=>{mobileMenu.classList.toggle('active');navMenu.classList.toggle('active')});document.querySelectorAll('.nav-link').forEach(link=>{link.addEventListener('click',()=>{mobileMenu.classList.remove('active');navMenu.classList.remove('active')})});function exitProductView(){document.body.classList.remove('product-view');document.querySelectorAll('.product-page').forEach(page=>{page.classList.remove('active');page.style.display='none'});const productPagesContainer=document.getElementById('product-pages');if(productPagesContainer){productPagesContainer.style.display='none'}}document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener('click',function(e){const href=this.getAttribute('href');if(!href||href==='#')return;const target=document.querySelector(href);if(!target)return;e.preventDefault();if(document.body.classList.contains('product-view')){exitProductView()}if(mobileMenu&&navMenu){mobileMenu.classList.remove('active');navMenu.classList.remove('active')}requestAnimationFrame(()=>{target.scrollIntoView({behavior:'smooth',block:'start'})})})});window.addEventListener('scroll',()=>{const navbar=document.querySelector('.navbar');if(window.scrollY>100){navbar.style.background='rgba(255, 255, 255, 0.98)';navbar.style.boxShadow='0 2px 20px rgba(0,0,0,0.1)'}else{navbar.style.background='rgba(255, 255, 255, 0.95)';navbar.style.boxShadow='none'}});const contactForm=document.querySelector('.contact-form');if(contactForm){const hasExternalAction=!!contactForm.getAttribute('action');if(!hasExternalAction){contactForm.addEventListener('submit',e=>{e.preventDefault();const name=contactForm.querySelector('input[type="text"]').value;const email=contactForm.querySelector('input[type="email"]').value;const message=contactForm.querySelector('textarea').value;if(!name||!email||!message){alert('Por favor, completa todos los campos.');return}const submitBtn=contactForm.querySelector('.btn');const originalText=submitBtn.textContent;submitBtn.textContent='Enviando...';submitBtn.disabled=true;setTimeout(()=>{alert('¡Mensaje enviado correctamente! Te contactaré pronto.');contactForm.reset();submitBtn.textContent=originalText;submitBtn.disabled=false},2000)})}}const observerOptions={threshold:.1,rootMargin:'0px 0px -50px 0px'};const observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.style.opacity='1';entry.target.style.transform='translateY(0)'}})},observerOptions);document.addEventListener('DOMContentLoaded',()=>{const animatedElements=document.querySelectorAll('.service-card, .about-text, .contact-item');animatedElements.forEach(el=>{el.style.opacity='0';el.style.transform='translateY(30px)';el.style.transition='opacity 0.6s ease, transform 0.6s ease';observer.observe(el)})});document.querySelectorAll('.service-card').forEach(card=>{card.addEventListener('mouseenter',()=>{card.style.transform='translateY(-10px) scale(1.02)'});card.addEventListener('mouseleave',()=>{card.style.transform='translateY(0) scale(1)'}))});function typeWriter(element,text,speed=100){let i=0;element.innerHTML='';function type(){if(i<text.length){element.innerHTML+=text.charAt(i);i++;setTimeout(type,speed)}}type()}window.addEventListener('load',()=>{const heroTitle=document.getElementById('typing-title');if(heroTitle){const originalText=heroTitle.textContent;typeWriter(heroTitle,originalText,80)}});window.addEventListener('scroll',()=>{const scrolled=window.pageYOffset;const hero=document.querySelector('.hero');const heroContent=document.querySelector('.hero-content');if(hero&&heroContent){heroContent.style.transform=`translateY(${scrolled*.5}px)`}});function showProductPage(pageId){console.log('Mostrando página:',pageId);document.body.classList.add('product-view');document.querySelectorAll('.product-page').forEach(page=>{page.classList.remove('active');page.style.display='none'});const targetPage=document.getElementById(pageId+'-page');console.log('Página encontrada:',targetPage);if(targetPage){targetPage.style.display='block';targetPage.classList.add('active');const productPagesContainer=document.getElementById('product-pages');if(productPagesContainer){productPagesContainer.style.display='block'}}window.scrollTo({top:0,behavior:'smooth'})}function goBack(){console.log('Volviendo atrás');document.body.classList.remove('product-view');document.querySelectorAll('.product-page').forEach(page=>{page.classList.remove('active');page.style.display='none'});const productPagesContainer=document.getElementById('product-pages');if(productPagesContainer){productPagesContainer.style.display='none'}const productsSection=document.getElementById('productos');if(productsSection){productsSection.scrollIntoView({behavior:'smooth'})}}document.addEventListener('DOMContentLoaded',()=>{const productButtons={construccion:'construccion',medicos:'medicos',oficina:'oficina',muebles:'muebles',electrodomesticos:'electrodomesticos'};Object.entries(productButtons).forEach(([buttonClass,pageId])=>{const buttons=document.querySelectorAll(`.${buttonClass}-btn`);buttons.forEach(button=>{button.addEventListener('click',e=>{e.preventDefault();showProductPage(pageId)})})})});let cart=[];function updateCartCount(){}function addToCart(productName){}function addCustomProduct(category){}function getCurrentCategory(){return'general'}function showCartNotification(productName){const notification=document.createElement('div');notification.className='cart-notification';notification.innerHTML=`
        <i class="fas fa-check-circle"></i>
        <span>Agregado al carrito: ${productName}</span>
    `;document.body.appendChild(notification);setTimeout(()=>notification.classList.add('show'),100);setTimeout(()=>{notification.classList.remove('show');setTimeout(()=>document.body.removeChild(notification),300)},3000)}function toggleCart(){const modal=document.getElementById('cart-modal');if(!modal)return;if(modal.style.display==='block'){modal.style.display='none'}else{modal.style.display='block';renderCartItems()}}function renderCartItems(){}function removeFromCart(itemId){}function clearCart(){cart=[]}function openQuoteModal(){const quoteModal=document.getElementById('quote-modal');if(!quoteModal)return;quoteModal.style.display='block'}function closeQuoteModal(){const quoteModal=document.getElementById('quote-modal');quoteModal.style.display='none';document.getElementById('quote-form').reset()}let uploadedFiles={};function handleFileUpload(input,category){const file=input.files[0];if(!file)return;const fileId=Date.now();const fileInfo={id:fileId,name:file.name,size:formatFileSize(file.size),type:file.type,category:category,file:file};if(!uploadedFiles[category]){uploadedFiles[category]=[]}uploadedFiles[category].push(fileInfo);displayFilePreview(fileInfo,category);showFileNotification(`Archivo "${file.name}" cargado correctamente`)}function formatFileSize(bytes){if(bytes===0)return'0 Bytes';const k=1024;const sizes=['Bytes','KB','MB','GB'];const i=Math.floor(Math.log(bytes)/Math.log(k));return parseFloat((bytes/Math.pow(k,i)).toFixed(2))+' '+sizes[i]}function displayFilePreview(fileInfo,category){const preview=document.getElementById(`file-preview-${category}`);const fileIcon=getFileIcon(fileInfo.type);const fileElement=document.createElement('div');fileElement.className='file-item';fileElement.innerHTML=`
        <div class="file-info">
            <i class="${fileIcon} file-icon"></i>
            <div class="file-details">
                <h5>${fileInfo.name}</h5>
                <small>${fileInfo.size}</small>
            </div>
        </div>
        <div class="file-actions">
            <button class="file-btn send-file" onclick="sendFileViaWhatsApp(${fileInfo.id}, '${category}')">
                <i class="fas fa-paper-plane"></i> Enviar
            </button>
            <button class="file-btn remove-file" onclick="removeFile(${fileInfo.id}, '${category}')">
                <i class="fas fa-trash"></i>
            </button>
        </div>
    `;preview.appendChild(fileElement)}function getFileIcon(fileType){if(fileType.includes('pdf'))return'fas fa-file-pdf';if(fileType.includes('word')||fileType.includes('document'))return'fas fa-file-word';if(fileType.includes('excel')||fileType.includes('spreadsheet'))return'fas fa-file-excel';if(fileType.includes('image'))return'fas fa-file-image';return'fas fa-file'}function sendFileViaWhatsApp(fileId,category){const fileInfo=uploadedFiles[category]?.find(f=>f.id===fileId);if(!fileInfo)return;const message=`Hola, tengo una cotización que necesito procesar. He subido el archivo: "${fileInfo.name}" (${fileInfo.size}). Por favor, ayúdenme con este pedido.`;const whatsappUrl=`https://wa.me/56962378434?text=${encodeURIComponent(message)}`;window.open(whatsappUrl,'_blank');showFileNotification('Redirigiendo a WhatsApp para enviar el archivo...')}function removeFile(fileId,category){if(!uploadedFiles[category])return;uploadedFiles[category]=uploadedFiles[category].filter(f=>f.id!==fileId);const preview=document.getElementById(`file-preview-${category}`);const fileElements=preview.querySelectorAll('.file-item');fileElements.forEach(element=>{const sendBtn=element.querySelector('.send-file');if(sendBtn&&sendBtn.onclick.toString().includes(fileId)){element.remove()}})}function showFileNotification(message){const notification=document.createElement('div');notification.className='cart-notification';notification.innerHTML=`
        <i class="fas fa-file-check"></i>
        <span>${message}</span>
    `;document.body.appendChild(notification);setTimeout(()=>notification.classList.add('show'),100);setTimeout(()=>{notification.classList.remove('show');setTimeout(()=>document.body.removeChild(notification),300)},4000)}function openImprovementModal(){const modal=document.getElementById('improvement-modal');modal.style.display='block'}function closeImprovementModal(){const modal=document.getElementById('improvement-modal');modal.style.display='none';document.getElementById('improvement-form').reset();document.getElementById('improvement-file-preview').innerHTML=''}function handleImprovementFile(input){const file=input.files[0];if(!file)return;const preview=document.getElementById('improvement-file-preview');const fileIcon=getFileIcon(file.type);preview.innerHTML=`
        <div class="file-item">
            <div class="file-info">
                <i class="${fileIcon} file-icon"></i>
                <div class="file-details">
                    <h5>${file.name}</h5>
                    <small>${formatFileSize(file.size)}</small>
                </div>
            </div>
            <div class="file-actions">
                <button type="button" class="file-btn remove-file" onclick="removeImprovementFile()">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </div>
    `}function removeImprovementFile(){document.getElementById('imp-quote-file').value='';document.getElementById('improvement-file-preview').innerHTML=''}function handleImprovementSubmission(e){e.preventDefault();const formData={name:document.getElementById('imp-name').value,email:document.getElementById('imp-email').value,company:document.getElementById('imp-company').value,phone:document.getElementById('imp-phone').value,currentSupplier:document.getElementById('imp-current-supplier').value,deadline:document.getElementById('imp-deadline').value,message:document.getElementById('imp-message').value,file:document.getElementById('imp-quote-file').files[0]};sendImprovementRequest(formData)}function sendImprovementRequest(formData){const submitBtn=document.querySelector('#improvement-form button[type="submit"]');const originalText=submitBtn.innerHTML;submitBtn.innerHTML='<i class="fas fa-spinner fa-spin"></i> Enviando...';submitBtn.disabled=true;setTimeout(()=>{const deadlineText={urgente:'Urgente (24 horas)',rapido:'Rápido (2-3 días)',normal:'Normal (1 semana)',flexible:'Flexible (cuando sea posible)'};const emailContent=`
Nueva Solicitud de Análisis de Cotización Competitiva

Datos del Cliente:
- Nombre: ${formData.name}
- Email: ${formData.email}
- Empresa: ${formData.company}
- Teléfono: ${formData.phone||'No especificado'}
- Proveedor Actual: ${formData.currentSupplier||'No especificado'}

Urgencia: ${deadlineText[formData.deadline]}

Archivo adjunto: ${formData.file?formData.file.name:'No adjuntado'}

Información adicional:
${formData.message||'Ninguna'}

IMPORTANTE: El cliente entiende que no se garantizan mejores precios, 
solo se realizará un análisis según disponibilidad y condiciones del mercado.

---
Enviado desde el sitio web de PRODUCTOS JORAN SPA
        `;console.log('Solicitud de mejora enviada a cotizaciones@joran.cl:',emailContent);showCartNotification('Solicitud enviada. Te contactaremos para analizar tu cotización.');closeImprovementModal();submitBtn.innerHTML=originalText;submitBtn.disabled=false},2000)}document.addEventListener('DOMContentLoaded',()=>{updateCartCount();const quoteForm=document.getElementById('quote-form');if(quoteForm){const hasExternalAction=!!quoteForm.getAttribute('action');if(!hasExternalAction){quoteForm.addEventListener('submit',handleQuoteSubmission)}}const improvementForm=document.getElementById('improvement-form');if(improvementForm){const hasExternalAction=!!improvementForm.getAttribute('action');if(!hasExternalAction){improvementForm.addEventListener('submit',handleImprovementSubmission)}}});function handleQuoteSubmission(e){e.preventDefault();const formData={name:document.getElementById('quote-name').value,email:document.getElementById('quote-email').value,company:document.getElementById('quote-company').value,phone:document.getElementById('quote-phone').value,message:document.getElementById('quote-message').value,products:cart};sendQuoteEmail(formData)}function sendQuoteEmail(formData){const submitBtn=document.querySelector('#quote-form button[type="submit"]');const originalText=submitBtn.innerHTML;submitBtn.innerHTML='<i class="fas fa-spinner fa-spin"></i> Enviando...';submitBtn.disabled=true;setTimeout(()=>{const productList=formData.products.map(item=>`• ${item.name}${item.custom?' (Personalizado)':''}`).join('\n');const emailContent=`
Nueva Solicitud de Cotización

Datos del Cliente:
- Nombre: ${formData.name}
- Email: ${formData.email}
- Empresa: ${formData.company||'No especificada'}
- Teléfono: ${formData.phone||'No especificado'}

Productos solicitados:
${productList}

Mensaje adicional:
${formData.message||'Ninguno'}

---
Enviado desde el sitio web de PRODUCTOS JORAN SPA
        `;console.log('Email enviado a cotizaciones@joran.cl:',emailContent);showCartNotification('Cotización enviada correctamente al correo cotizaciones@joran.cl');closeQuoteModal();clearCart();submitBtn.innerHTML=originalText;submitBtn.disabled=false},2000)}window.addEventListener('load',()=>{document.body.style.opacity='0';document.body.style.transition='opacity 0.5s ease';setTimeout(()=>{document.body.style.opacity='1'},100)});
